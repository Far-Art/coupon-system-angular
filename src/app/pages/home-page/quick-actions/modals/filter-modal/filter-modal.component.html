<cs-modal *ngIf="form" id="filterModal">
  <cs-modal-header [title]="'filters'"></cs-modal-header>
  <cs-modal-body>
    <form class="border-0" [formGroup]="form">
      <div class="accordion drop-shadow-low rounded-2" id="accordion">
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed"
                    type="button"
                    [disabled]="form.controls.freeText.value.value"
                    data-bs-toggle="collapse"
                    data-bs-target="#categoriesCollapse"
                    aria-expanded="true"
                    aria-controls="categoriesCollapse">
              Categories
            </button>
          </h2>
          <div id="categoriesCollapse" class="drop-inset-shadow accordion-collapse collapse" data-bs-parent="#accordion">
            <div class="accordion-body" formArrayName="categories">
              <div class="form-check user-select-none m-2"
                   [formGroupName]="i"
                   *ngFor="let c of form.controls.categories.controls; let i = index">
                <input class="form-check-input drop-shadow-low"
                       type="checkbox"
                       id="{{c.value.value}}"
                       formControlName="isChecked">
                <label class="form-check-label text-hover"
                       [ngClass]="{'text-primary': c.value.isChecked}"
                       for="{{c.value.value}}">{{ c.value.value | titlecase }}
                </label>
              </div>
              <hr>
              <a class="text-hover left-90 position-relative" (click)="onCategoryReset()">reset</a>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed"
                    type="button"
                    [disabled]="form.controls.freeText.value.value"
                    data-bs-toggle="collapse"
                    data-bs-target="#companiesCollapse"
                    aria-expanded="false"
                    aria-controls="companiesCollapse">
              Companies
            </button>
          </h2>
          <div id="companiesCollapse" class="drop-inset-shadow accordion-collapse collapse" data-bs-parent="#accordion">
            <div class="accordion-body" formArrayName="companyNames">
              <div class="form-check user-select-none m-2"
                   [formGroupName]="i"
                   *ngFor="let c of form.controls.companyNames.controls; let i = index">
                <input class="form-check-input drop-shadow-low"
                       type="checkbox"
                       id="{{c.value.value + i}}"
                       formControlName="isChecked">
                <label class="form-check-label text-hover"
                       [ngClass]="{'text-primary': c.value.isChecked}"
                       for="{{c.value.value + i}}">{{ c.value.value | titlecase }}
                </label>
              </div>
              <hr>
              <a class="text-hover position-relative left-90" (click)="onCompanyReset()">reset</a>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed"
                    [disabled]="form.controls.freeText.value.value"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#priceCollapse"
                    aria-expanded="false"
                    aria-controls="priceCollapse">
              Price
            </button>
          </h2>
          <div id="priceCollapse" class="drop-inset-shadow accordion-collapse collapse" data-bs-parent="#accordion">
            <div class="accordion-body">
              <div class="row align-content-center" formGroupName="priceRange">
                <div class="col flex-grow-1">
                  <div class="input-group drop-shadow-low">
                    <span class="input-group-text fs-4">₪</span>
                    <div class="form-floating">
                      <input type="number"
                             class="form-control"
                             formControlName="start"
                             id="minPrice"
                             placeholder="min price"
                             [min]="filters.priceRange.start"
                             [max]="filters.priceRange.end">
                      <label for="minPrice">Min price</label>
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="input-group drop-shadow-low">
                    <span class="input-group-text fs-4">₪</span>
                    <div class="form-floating">
                      <input type="number"
                             class="form-control"
                             id="maxPrice"
                             placeholder="max price"
                             formControlName="end"
                             [min]="filters.priceRange.start"
                             [max]="filters.priceRange.end">
                      <label for="minPrice">Max price</label>
                    </div>
                  </div>
                  <br>
                </div>
              </div>
              <a class="text-hover position-relative left-90" (click)="onPriceReset()">reset</a>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed"
                    [disabled]="form.controls.freeText.value.value"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#dateCollapse"
                    aria-expanded="false"
                    aria-controls="dateCollapse">
              Date
            </button>
          </h2>
          <div id="dateCollapse" class="drop-inset-shadow accordion-collapse collapse" data-bs-parent="#accordion">
            <div class="accordion-body">
              <div class="row align-content-center" formGroupName="dateRange">
                <div class="row align-content-center">
                  <div class="col-sm-3 align-self-center">
                    Start date
                  </div>
                  <div class="col-sm-5 mb-2">
                    <sc-date-picker formControlName="start"
                                    id="startDate"
                                    [minDate]="filters.dateRange.start"
                                    [maxDate]="filters.dateRange.end">
                    </sc-date-picker>
                  </div>
                </div>
                <div class="row align-content-center">
                  <div class="col-sm-3 align-self-center">
                    End date
                  </div>
                  <div class="col-sm-5">
                    <sc-date-picker formControlName="end"
                                    id="endDate"
                                    [minDate]="filters.dateRange.start"
                                    [maxDate]="filters.dateRange.end">
                    </sc-date-picker>
                    <br>
                  </div>
                </div>
              </div>
              <a class="text-hover position-relative left-90" (click)="onDateReset()">reset</a>
            </div>
          </div>
        </div>
      </div>
      <br>

      <div formGroupName="freeText">
        <cs-form-input type="search" placeholder="Free text search" formGroupName="freeText" formControlName="value"></cs-form-input>
      </div>

      <div class="form-check user-select-none m-1 mt-4"
           formGroupName="hidePurchased">
        <input class="form-check-input drop-shadow-low"
               type="checkbox"
               id="hidePurchased"
               formControlName="isChecked">
        <label class="form-check-label text-hover"
               [ngClass]="{'text-primary': form.controls.hidePurchased.value.isChecked}"
               for="hidePurchased">Hide Purchased Coupons
        </label>
      </div>
    </form>
  </cs-modal-body>
  <cs-modal-footer>
    <cs-modal-button class="btn btn-outline-danger" action="close" type="reset" (click)="onFormReset()">Reset</cs-modal-button>
    <cs-modal-button class="btn btn-outline-secondary" action="close" (click)="onCancel()" aria-label="Cancel">Cancel</cs-modal-button>
    <cs-modal-button class="btn btn-outline-success" action="close" type="submit" (click)="onSubmit()" [disabled]="form.controls.freeText.invalid" aria-label="Apply filters">Apply</cs-modal-button>
  </cs-modal-footer>
</cs-modal>
